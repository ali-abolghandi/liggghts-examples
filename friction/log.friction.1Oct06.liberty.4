LAMMPS (1 Oct 2006)
# 2d friction simulation

dimension	2
boundary	p s p

atom_style	atomic
neighbor	0.3 bin
neigh_modify	delay 5

# create geometry

lattice		hex 0.9
region		box block 0 50 0 22 -0.25 0.25
create_box	4 box
Created box = (0 0 -0.283174) to (56.6348 43.1615 0.283174)
  2 by 2 by 1 processor grid

mass		1 1.0
mass		2 1.0
mass		3 1.0
mass		4 1.0

# atom regions

region          lo-fixed block INF INF INF 1.1 INF INF
region          lo-slab block INF INF INF 7 INF INF
region          above-lo block INF INF INF 7 INF INF side out
region          hi-fixed block INF INF 20.9 INF INF INF
region          hi-slab block INF INF 15 INF INF INF
region          below-hi block INF INF 15 INF INF INF side out
region		lo-asperity sphere 32 7 0 8
region		hi-asperity sphere 18 15 0 8
region		lo-half-sphere intersect 2 lo-asperity above-lo
region		hi-half-sphere intersect 2 hi-asperity below-hi

# create 2 surfaces with asperities

create_atoms	1 lo-slab
Created 750 atoms
create_atoms	1 hi-slab
Created 750 atoms
create_atoms	2 lo-half-sphere
Created 112 atoms
create_atoms	3 hi-half-sphere
Created 112 atoms

# LJ potentials

pair_style	lj/cut 2.5
pair_coeff	* * 1.0 1.0 2.5

# define groups

group	        lo region lo-slab
750 atoms in group lo
group		lo type 2
862 atoms in group lo
group		hi region hi-slab
750 atoms in group hi
group		hi type 3
862 atoms in group hi
group		lo-fixed region lo-fixed
150 atoms in group lo-fixed
group		hi-fixed region hi-fixed
150 atoms in group hi-fixed
group		boundary union lo-fixed hi-fixed
300 atoms in group boundary
group		mobile subtract all boundary
1424 atoms in group mobile

set		lo-fixed atom 4
  150 settings made
set		hi-fixed atom 4
  150 settings made

# initial velocities

temperature     new mobile partial 0 1 0
velocity	mobile create 0.1 482748 temp new
velocity	hi set 1.0 0.0 0.0 sum yes

# fixes

fix		1 all nve
fix		2 boundary setforce 0.0 0.0 0.0
fix		3 mobile temp/rescale 200 0.1 0.1 0.02 1.0
fix_modify	3 temp new

# Run

timestep	0.0025
thermo		1000
thermo_modify	temp new

dump		1 all atom 100 dump.friction
run		20000
Memory usage per processor = 1.4603 Mbytes
Step Temp E_pair E_mol TotEng Press Volume 
       0          0.1   -3.1333672            0   -3.0921549   -1.3466755    1384.4128 
    1000   0.08936608    -3.060858            0   -3.0240282  0.018536372    1384.4128 
    2000  0.087353242   -3.0615115            0   -3.0255112  -0.58816858    1384.4128 
    3000  0.097185838   -3.0626106            0   -3.0225581 -0.099745896    1384.4128 
    4000   0.10514697   -3.0540883            0   -3.0107549  -0.40469143    1384.4128 
    5000   0.10965701   -3.0502726            0   -3.0050804   0.15587748    1384.4128 
    6000    0.1142368   -3.0461587            0   -2.9990791  -0.27554064    1384.4128 
    7000          0.1    -3.038824            0   -2.9976117  -0.38655949    1384.4128 
    8000   0.11116929   -3.0485103            0   -3.0026949  -0.50529564    1384.4128 
    9000   0.11426746    -3.044549            0   -2.9974568   -0.4678125    1384.4128 
   10000   0.10652378   -3.0503221            0   -3.0064212  -0.52457375    1384.4128 
   11000    0.1102547   -3.0498241            0   -3.0043856  -0.45053087    1384.4128 
   12000   0.11548097   -3.0510641            0   -3.0034718  -0.27052982    1384.4128 
   13000   0.10919538   -3.0438158            0   -2.9988139  -0.53868739    1384.4128 
   14000   0.10742456    -3.045668            0   -3.0013959  -0.25306386    1384.4128 
   15000   0.10795006   -3.0436862            0   -2.9991975  -0.44644395    1384.4128 
   16000   0.11271512   -3.0478462            0   -3.0013937  -0.28516203    1384.4128 
   17000   0.11209577   -3.0497319            0   -3.0035347  -0.39432942    1384.4128 
   18000          0.1    -3.050733            0   -3.0095207  -0.34607727    1384.4128 
   19000  0.092061676    -3.048521            0   -3.0105803  -0.37268438    1384.4128 
   20000   0.10666663   -3.0598394            0   -3.0158797  -0.33025583    1384.4128 
Loop time of 8.99743 on 4 procs for 20000 steps with 1724 atoms

Pair  time (%) = 3.6897 (41.0084)
Neigh time (%) = 0.202473 (2.25034)
Comm  time (%) = 3.18145 (35.3595)
Outpt time (%) = 0.579402 (6.43964)
Other time (%) = 1.3444 (14.9421)

Nlocal:    431 ave 484 max 381 min
Histogram: 1 1 0 0 0 0 0 1 0 1
Nghost:    100.5 ave 119 max 87 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:    3597.5 ave 4163 max 3176 min
Histogram: 2 0 0 0 0 0 1 0 0 1

Total # of neighbors = 14390
Ave neighs/atom = 8.34687
Neighbor list builds = 720
Dangerous builds = 0
