LAMMPS (1 Oct 2006)
# 2-d LJ flow simulation

dimension	2
boundary	p s p

atom_style	atomic
neighbor	0.3 bin
neigh_modify	delay 5

# create geometry

lattice		hex 0.7
region		box block 0 20 0 10 -0.25 0.25
create_box	3 box
Created box = (0 0 -0.321089) to (25.6871 22.2457 0.321089)
  1 by 1 by 1 processor grid
create_atoms	1
Created 420 atoms

mass		1 1.0
mass		2 1.0
mass		3 1.0

# LJ potentials

pair_style	lj/cut 1.12246
pair_coeff	* * 1.0 1.0 1.12246

# define groups

region	     1 block INF INF INF 1.25 INF INF
group	     lower region 1
60 atoms in group lower
region	     2 block INF INF 8.75 INF INF INF
group	     upper region 2
60 atoms in group upper
group	     boundary union lower upper
120 atoms in group boundary
group	     flow subtract all boundary
300 atoms in group flow

set	     lower atom 2
  60 settings made
set	     upper atom 3
  60 settings made

# initial velocities

temperature  mobile flow full
velocity     flow create 1.0 482748 temp mobile
fix	     1 all nve
fix	     2 flow temp/rescale 200 1.0 1.0 0.02 1.0
fix_modify   2 temp mobile

# Couette flow

velocity     lower set 0.0 0.0 0.0
velocity     upper set 3.0 0.0 0.0
fix	     3 boundary setforce 0.0 0.0 0.0
fix	     4 all enforce2d

# Poisseuille flow

#velocity     boundary set 0.0 0.0 0.0
#fix	     3 lower setforce 0.0 0.0 0.0
#fix	     4 upper setforce 0.0 NULL 0.0
#fix	     5 upper aveforce 0.0 -1.0 0.0
#fix	     6 flow addforce 0.5 0.0 0.0
#fix	     7 all enforce2d

# Run

timestep	0.003
thermo		500
thermo_modify	temp mobile

dump		1 all atom 50 dump.flow
run		10000
Memory usage per processor = 1.45035 Mbytes
Step Temp E_pair E_mol TotEng Press Volume 
       0            1            0            0   0.71071429   0.54228995    366.96236 
     500    1.0604224  -0.31549525            0    0.4381621    3.1208962    366.96236 
    1000            1  -0.34356865            0   0.36714563    3.0305145    366.96236 
    1500    1.1738082  -0.38202601            0   0.45221625    2.9197883    366.96236 
    2000            1  -0.42682396            0   0.28389033    2.8469301    366.96236 
    2500     1.024752  -0.41856176            0   0.30974413    2.9396683    366.96236 
    3000            1  -0.43670738            0   0.27400691    2.7241981    366.96236 
    3500    1.0895615  -0.42577755            0   0.34858934    2.6026891    366.96236 
    4000            1  -0.44573495            0   0.26497934    2.4799192    366.96236 
    4500    1.0711285   -0.4375466            0   0.32371976    2.8408151    366.96236 
    5000            1  -0.46692482            0   0.24378947    2.7249453    366.96236 
    5500    1.0960047    -0.497188            0   0.28175821    2.5610363    366.96236 
    6000            1   -0.4129622            0   0.29775209    2.3978555    366.96236 
    6500    1.0887159  -0.39206737            0    0.3816986    2.5437398    366.96236 
    7000            1  -0.36776877            0   0.34294551    2.7427873    366.96236 
    7500    1.1794747  -0.45276333            0   0.38550621    2.4854834    366.96236 
    8000            1  -0.42255618            0    0.2881581    2.5061969    366.96236 
    8500     1.098024  -0.45909879            0   0.32128255    2.4143874    366.96236 
    9000            1  -0.42247096            0   0.28824333    2.2773041    366.96236 
    9500    1.1248064  -0.40810854            0   0.39130741    2.1964254    366.96236 
   10000            1  -0.36640887            0   0.34430541    2.4787391    366.96236 
Loop time of 2.20605 on 1 procs for 10000 steps with 420 atoms

Pair  time (%) = 0.754591 (34.2056)
Neigh time (%) = 0.308539 (13.9861)
Comm  time (%) = 0.107975 (4.8945)
Outpt time (%) = 0.41017 (18.593)
Other time (%) = 0.624773 (28.3209)

Nlocal:    420 ave 420 max 420 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    50 ave 50 max 50 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    957 ave 957 max 957 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 957
Ave neighs/atom = 2.27857
Neighbor list builds = 1000
Dangerous builds = 0
