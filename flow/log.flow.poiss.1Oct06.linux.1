LAMMPS (1 Oct 2006)
# 2-d LJ flow simulation

dimension	2
boundary	p s p

atom_style	atomic
neighbor	0.3 bin
neigh_modify	delay 5

# create geometry

lattice		hex 0.7
region		box block 0 20 0 10 -0.25 0.25
create_box	3 box
Created box = (0 0 -0.321089) to (25.6871 22.2457 0.321089)
  1 by 1 by 1 processor grid
create_atoms	1
Created 420 atoms

mass		1 1.0
mass		2 1.0
mass		3 1.0

# LJ potentials

pair_style	lj/cut 1.12246
pair_coeff	* * 1.0 1.0 1.12246

# define groups

region	     1 block INF INF INF 1.25 INF INF
group	     lower region 1
60 atoms in group lower
region	     2 block INF INF 8.75 INF INF INF
group	     upper region 2
60 atoms in group upper
group	     boundary union lower upper
120 atoms in group boundary
group	     flow subtract all boundary
300 atoms in group flow

set	     lower atom 2
  60 settings made
set	     upper atom 3
  60 settings made

# initial velocities

temperature  mobile flow full
velocity     flow create 1.0 482748 temp mobile
fix	     1 all nve
fix	     2 flow temp/rescale 200 1.0 1.0 0.02 1.0
fix_modify   2 temp mobile

# Couette flow

#velocity     lower set 0.0 0.0 0.0
#velocity     upper set 3.0 0.0 0.0
#fix	     3 boundary setforce 0.0 0.0 0.0
#fix	     4 all enforce2d

# Poisseuille flow

velocity     boundary set 0.0 0.0 0.0
fix	     3 lower setforce 0.0 0.0 0.0
fix	     4 upper setforce 0.0 NULL 0.0
fix	     5 upper aveforce 0.0 -1.0 0.0
fix	     6 flow addforce 0.5 0.0 0.0
fix	     7 all enforce2d

# Run

timestep	0.003
thermo		500
thermo_modify	temp mobile

dump		1 all atom 25 dump.flow
run		10000
Memory usage per processor = 1.45035 Mbytes
Step Temp E_pair E_mol TotEng Press Volume 
       0            1            0            0   0.71071429   0.54228995    366.96236 
     500    1.1036177  -0.37435595            0    0.4100009    2.6003586    369.52344 
    1000            1  -0.40278179            0   0.30793249    2.0566706    375.56836 
    1500    1.2346487  -0.41204291            0   0.46543956    1.6254791    376.55032 
    2000            1  -0.40773469            0    0.3029796    1.5174808    374.73899 
    2500    1.2225527  -0.43831256            0   0.43057311     1.538442    366.48806 
    3000            1  -0.49535329            0     0.215361    1.5818851    355.29346 
    3500    1.2493652  -0.59970719            0   0.28823452    1.7494829     344.5223 
    4000            1  -0.67604277            0  0.034671516    2.0751068    332.82226 
    4500    1.1963622  -0.74392294            0   0.10634877    2.9790662    322.98092 
    5000            1  -0.77322139            0 -0.062507105    3.3772359    320.78002 
    5500    1.2048992  -0.77634312            0  0.079995929    2.9951611    324.35044 
    6000            1  -0.68526989            0  0.025444398    2.3511721    331.72304 
    6500    1.2079513  -0.59742461            0   0.26108363    1.8598207    336.52669 
    7000            1  -0.60208737            0   0.10862692    1.9011673    336.55357 
    7500    1.2390152  -0.68215629            0   0.19842954    1.9783028     333.8701 
    8000            1  -0.69342292            0   0.01729137    2.3176685    328.52309 
    8500      1.23233  -0.69508948            0   0.18074504    2.4605225     324.4685 
    9000            1  -0.78017888            0 -0.069464593    2.5102443    323.83769 
    9500    1.2049045  -0.78839912            0  0.067943719    2.6572163    323.67252 
   10000            1  -0.72912664            0 -0.018412351    2.4438564    325.74175 
Loop time of 2.71301 on 1 procs for 10000 steps with 420 atoms

Pair  time (%) = 0.850197 (31.3377)
Neigh time (%) = 0.171296 (6.31386)
Comm  time (%) = 0.096819 (3.56869)
Outpt time (%) = 0.824351 (30.3851)
Other time (%) = 0.770352 (28.3947)

Nlocal:    420 ave 420 max 420 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    47 ave 47 max 47 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1117 ave 1117 max 1117 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1117
Ave neighs/atom = 2.65952
Neighbor list builds = 558
Dangerous builds = 0
