LAMMPS (1 Oct 2006)
# 2-d LJ flow simulation

dimension	2
boundary	p s p

atom_style	atomic
neighbor	0.3 bin
neigh_modify	delay 5

# create geometry

lattice		hex 0.7
region		box block 0 20 0 10 -0.25 0.25
create_box	3 box
Created box = (0 0 -0.321089) to (25.6871 22.2457 0.321089)
  2 by 2 by 1 processor grid
create_atoms	1
Created 420 atoms

mass		1 1.0
mass		2 1.0
mass		3 1.0

# LJ potentials

pair_style	lj/cut 1.12246
pair_coeff	* * 1.0 1.0 1.12246

# define groups

region	     1 block INF INF INF 1.25 INF INF
group	     lower region 1
60 atoms in group lower
region	     2 block INF INF 8.75 INF INF INF
group	     upper region 2
60 atoms in group upper
group	     boundary union lower upper
120 atoms in group boundary
group	     flow subtract all boundary
300 atoms in group flow

set	     lower atom 2
  60 settings made
set	     upper atom 3
  60 settings made

# initial velocities

temperature  mobile flow full
velocity     flow create 1.0 482748 temp mobile
fix	     1 all nve
fix	     2 flow temp/rescale 200 1.0 1.0 0.02 1.0
fix_modify   2 temp mobile

# Couette flow

#velocity     lower set 0.0 0.0 0.0
#velocity     upper set 3.0 0.0 0.0
#fix	     3 boundary setforce 0.0 0.0 0.0
#fix	     4 all enforce2d

# Poisseuille flow

velocity     boundary set 0.0 0.0 0.0
fix	     3 lower setforce 0.0 0.0 0.0
fix	     4 upper setforce 0.0 NULL 0.0
fix	     5 upper aveforce 0.0 -1.0 0.0
fix	     6 flow addforce 0.5 0.0 0.0
fix	     7 all enforce2d

# Run

timestep	0.003
thermo		500
thermo_modify	temp mobile

dump		1 all atom 25 dump.flow
run		10000
Memory usage per processor = 1.44615 Mbytes
Step Temp E_pair E_mol TotEng Press Volume 
       0            1            0            0   0.71071429   0.54228995    366.96236 
     500    1.0778761  -0.35048279            0   0.41557918    2.8792129    369.20271 
    1000            1  -0.38740705            0   0.32330724    2.2684877    375.93354 
    1500    1.2052679  -0.37768559            0   0.47891551    1.6193029    376.17118 
    2000            1  -0.38060118            0   0.33011311    1.4972142    371.27032 
    2500    1.2211446  -0.39689946            0   0.47098547    1.5612989    364.09539 
    3000            1   -0.4663268            0   0.24438748    1.5629904    356.17692 
    3500    1.2338563  -0.57458788            0    0.3023314    1.8175737    344.96843 
    4000            1  -0.69828914            0  0.012425149    2.3062239    333.07337 
    4500    1.2223948  -0.68025643            0   0.18851702    3.0030445    323.53576 
    5000            1  -0.77041655            0 -0.059702267    3.1645089    320.77015 
    5500     1.206787  -0.74655306            0   0.11112772    2.6751057    324.35217 
    6000            1  -0.68123467            0  0.029479617    2.3163646    329.78023 
    6500    1.1974539  -0.67787899            0   0.17316861    2.1501471    332.21584 
    7000            1  -0.63878551            0  0.071928781    1.9059071      332.869 
    7500    1.2099494   -0.6450312            0   0.21489713    2.0613881    331.14731 
    8000            1    -0.662565            0  0.048149283    2.1186993    326.88679 
    8500    1.2200684  -0.75842085            0   0.10869919     2.566873    324.24936 
    9000            1  -0.72471449            0   -0.0140002    2.5966104    323.69555 
    9500    1.1858651  -0.72008706            0   0.12272424    2.6583911    324.95806 
   10000            1   -0.6877267            0  0.022987584     2.263132    327.94921 
Loop time of 2.32195 on 4 procs for 10000 steps with 420 atoms

Pair  time (%) = 0.0970009 (4.17756)
Neigh time (%) = 0.026122 (1.125)
Comm  time (%) = 1.20093 (51.7207)
Outpt time (%) = 0.296236 (12.758)
Other time (%) = 0.701664 (30.2187)

Nlocal:    105 ave 107 max 103 min
Histogram: 1 0 1 0 0 0 0 1 0 1
Nghost:    41.75 ave 42 max 41 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:    279 ave 283 max 274 min
Histogram: 1 0 0 0 1 0 0 1 0 1

Total # of neighbors = 1116
Ave neighs/atom = 2.65714
Neighbor list builds = 560
Dangerous builds = 0
