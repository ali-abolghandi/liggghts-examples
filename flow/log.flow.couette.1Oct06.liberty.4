LAMMPS (1 Oct 2006)
# 2-d LJ flow simulation

dimension	2
boundary	p s p

atom_style	atomic
neighbor	0.3 bin
neigh_modify	delay 5

# create geometry

lattice		hex 0.7
region		box block 0 20 0 10 -0.25 0.25
create_box	3 box
Created box = (0 0 -0.321089) to (25.6871 22.2457 0.321089)
  2 by 2 by 1 processor grid
create_atoms	1
Created 420 atoms

mass		1 1.0
mass		2 1.0
mass		3 1.0

# LJ potentials

pair_style	lj/cut 1.12246
pair_coeff	* * 1.0 1.0 1.12246

# define groups

region	     1 block INF INF INF 1.25 INF INF
group	     lower region 1
60 atoms in group lower
region	     2 block INF INF 8.75 INF INF INF
group	     upper region 2
60 atoms in group upper
group	     boundary union lower upper
120 atoms in group boundary
group	     flow subtract all boundary
300 atoms in group flow

set	     lower atom 2
  60 settings made
set	     upper atom 3
  60 settings made

# initial velocities

temperature  mobile flow full
velocity     flow create 1.0 482748 temp mobile
fix	     1 all nve
fix	     2 flow temp/rescale 200 1.0 1.0 0.02 1.0
fix_modify   2 temp mobile

# Couette flow

velocity     lower set 0.0 0.0 0.0
velocity     upper set 3.0 0.0 0.0
fix	     3 boundary setforce 0.0 0.0 0.0
fix	     4 all enforce2d

# Poisseuille flow

#velocity     boundary set 0.0 0.0 0.0
#fix	     3 lower setforce 0.0 0.0 0.0
#fix	     4 upper setforce 0.0 NULL 0.0
#fix	     5 upper aveforce 0.0 -1.0 0.0
#fix	     6 flow addforce 0.5 0.0 0.0
#fix	     7 all enforce2d

# Run

timestep	0.003
thermo		500
thermo_modify	temp mobile

dump		1 all atom 50 dump.flow
run		10000
Memory usage per processor = 1.44615 Mbytes
Step Temp E_pair E_mol TotEng Press Volume 
       0            1            0            0   0.71071429   0.54228995    366.96236 
     500    1.0967867   -0.3465085            0   0.43299345    3.3754137    366.96236 
    1000            1  -0.36129869            0    0.3494156     3.254923    366.96236 
    1500    1.1299217  -0.37859354            0   0.42445795    3.0386513    366.96236 
    2000            1  -0.34287377            0   0.36784052    3.1412593    366.96236 
    2500    1.0899881  -0.38633626            0   0.38833382    2.9555542    366.96236 
    3000            1  -0.39357685            0   0.31713744    2.9220544    366.96236 
    3500    1.0725076  -0.43228066            0   0.32996578    3.0634077    366.96236 
    4000   0.98425607  -0.50499218            0   0.19453267    2.6894642    366.96236 
    4500      1.12295  -0.43026613            0   0.36783048    2.8383488    366.96236 
    5000            1  -0.38936492            0   0.32134937    2.7396424    366.96236 
    5500    1.0704014  -0.42922975            0   0.33151984    2.9491395    366.96236 
    6000            1  -0.44518162            0   0.26553266     2.558761    366.96236 
    6500     1.027497  -0.39375667            0   0.33650011    2.6024776    366.96236 
    7000            1  -0.36769731            0   0.34301697    2.5197126    366.96236 
    7500    1.0817191  -0.41108702            0   0.35770623    2.5206643    366.96236 
    8000            1  -0.38737307            0   0.32334122    2.9522698    366.96236 
    8500    1.1947509  -0.43799992            0    0.4111266    2.5630133    366.96236 
    9000            1  -0.37870561            0   0.33200868    3.0568213    366.96236 
    9500    1.1262643  -0.38699772            0   0.41345443     2.631997    366.96236 
   10000            1  -0.39282605            0   0.31788823    2.7840067    366.96236 
Loop time of 1.95426 on 4 procs for 10000 steps with 420 atoms

Pair  time (%) = 0.093526 (4.78575)
Neigh time (%) = 0.0450768 (2.30659)
Comm  time (%) = 1.28476 (65.7414)
Outpt time (%) = 0.177726 (9.0943)
Other time (%) = 0.353174 (18.072)

Nlocal:    105 ave 113 max 98 min
Histogram: 2 0 0 0 0 0 0 0 1 1
Nghost:    41.5 ave 44 max 39 min
Histogram: 1 0 0 0 1 0 1 0 0 1
Neighs:    239.25 ave 292 max 197 min
Histogram: 2 0 0 0 0 0 0 1 0 1

Total # of neighbors = 957
Ave neighs/atom = 2.27857
Neighbor list builds = 997
Dangerous builds = 0
