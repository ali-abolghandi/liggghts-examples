LAMMPS (1 Oct 2006)
# 2d LJ obstacle flow

dimension	2
boundary	p s p

atom_style	atomic
neighbor	0.3 bin
neigh_modify	delay 5

# create geometry

lattice		hex 0.7
region		box block 0 40 0 10 -0.25 0.25
create_box	3 box
Created box = (0 0 -0.321089) to (51.3743 22.2457 0.321089)
  4 by 1 by 1 processor grid
create_atoms	1
Created 840 atoms

mass		1 1.0
mass		2 1.0
mass		3 1.0

# LJ potentials

pair_style	lj/cut 1.12246
pair_coeff	* * 1.0 1.0 1.12246

# define groups

region	        1 block INF INF INF 1.25 INF INF
group		lower region 1
120 atoms in group lower
region		2 block INF INF 8.75 INF INF INF
group		upper region 2
120 atoms in group upper
group		boundary union lower upper
240 atoms in group boundary
group		flow subtract all boundary
600 atoms in group flow

set		lower atom 2
  120 settings made
set		upper atom 3
  120 settings made

# initial velocities

temperature     mobile flow full
velocity	flow create 1.0 482748 temp mobile
fix		1 all nve
fix		2 flow temp/rescale 200 1.0 1.0 0.02 1.0
fix_modify	2 temp mobile

# Poiselle flow

velocity	boundary set 0.0 0.0 0.0
fix		3 lower setforce 0.0 0.0 0.0
fix		4 upper setforce 0.0 NULL 0.0
fix		5 upper aveforce 0.0 -0.5 0.0
fix		6 flow addforce 1.0 0.0 0.0

# 2 obstacles

region		void1 sphere 10 4 0 3
delete_atoms	region void1
Deleted 36 atoms, new total = 804
region		void2 sphere 20 7 0 3
delete_atoms	region void2
Deleted 37 atoms, new total = 767

fix		7 flow indent 100 sphere 10 4 0 4
fix		8 flow indent 100 sphere 20 7 0 4
fix		9 all enforce2d

# Run

timestep	0.003
thermo		1000
thermo_modify	temp mobile

dump		1 all atom 100 dump.obstacle
#dump		1 all custom 100 dump.custom tag type x y z vx vy 

run		25000
Memory usage per processor = 1.44234 Mbytes
Step Temp E_pair E_mol TotEng Press Volume 
       0    1.0026027            0            0   0.68692013   0.47858472    733.92473 
    1000            1  -0.37738477            0   0.30775213    1.5583691    784.71717 
    2000            1  -0.41654339            0   0.26859351    1.4383017    811.91076 
    3000            1    -0.457908            0   0.22722889    1.4560268    840.96593 
    4000            1  -0.49703654            0   0.18810036    1.6667159    875.09273 
    5000            1   -0.5036762            0   0.18146069    1.5201858    896.06529 
    6000            1  -0.46146759            0   0.22366931    1.2626363    910.96886 
    7000            1  -0.45319553            0   0.23194137    1.2400164    919.79024 
    8000            1  -0.43703324            0   0.24810365    1.1687124    917.54854 
    9000            1  -0.41944398            0   0.26569292    1.1506946    919.08596 
   10000            1  -0.38212395            0   0.30301294    1.2159701    922.73564 
   11000            1  -0.40131109            0    0.2838258    1.0143617    928.59439 
   12000            1  -0.40729865            0   0.27783825    1.1463534    927.92228 
   13000            1  -0.40247949            0   0.28265741    1.0362177    932.66931 
   14000            1  -0.40708584            0   0.27805106      1.05021    931.20813 
   15000            1  -0.38885172            0   0.29628518   0.97302912    932.47567 
   16000            1  -0.36720972            0   0.31792717    1.0900379    929.29673 
   17000            1  -0.38146707            0   0.30366982    1.0608592    931.83222 
   18000            1  -0.38710515            0   0.29803175   0.91156243    940.47326 
   19000            1  -0.38215507            0   0.30298183     1.049551    937.81127 
   20000            1  -0.33197729            0   0.35315961   0.97020648    938.40346 
   21000            1  -0.33775592            0   0.34738098    1.0035901    932.85086 
   22000            1  -0.38733229            0   0.29780461    1.0175281    926.40207 
   23000            1  -0.35819884            0   0.32693805    1.0468418    927.63479 
   24000            1  -0.36327235            0   0.32186455    1.0859266    930.98575 
   25000            1  -0.41296958            0   0.27216731    1.0157726    929.59365 
Loop time of 4.53299 on 4 procs for 25000 steps with 767 atoms

Pair  time (%) = 0.355299 (7.83807)
Neigh time (%) = 0.1305 (2.87891)
Comm  time (%) = 1.82422 (40.2431)
Outpt time (%) = 0.366969 (8.09551)
Other time (%) = 1.856 (40.9444)

Nlocal:    191.75 ave 243 max 152 min
Histogram: 1 1 0 0 0 1 0 0 0 1
Nghost:    41.75 ave 45 max 40 min
Histogram: 1 0 2 0 0 0 0 0 0 1
Neighs:    405.5 ave 588 max 272 min
Histogram: 2 0 0 0 0 0 1 0 0 1

Total # of neighbors = 1622
Ave neighs/atom = 2.11473
Neighbor list builds = 1613
Dangerous builds = 0
